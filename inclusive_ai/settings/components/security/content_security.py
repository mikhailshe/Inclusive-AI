"""
Настройки Content Security Policy (CSP) для Django

Компонент отвечает за:
1. Конфигурацию политики безопасности контента (CSP)
2. Защиту от XSS-атак, инъекций и других атак на основе контента
3. Контроль над источниками ресурсов для веб-страницы
4. Настройки отчетов о нарушениях политики CSP
"""
from settings.settings import DEBUG

# ------------------ ОСНОВНЫЕ ДИРЕКТИВЫ CSP -------------------

# Источники по умолчанию для всех директив
CSP_DEFAULT_SRC = ["'self'"]

# Источники для скриптов JavaScript
CSP_SCRIPT_SRC = ["'self'"]

# Источники для таблиц стилей CSS
CSP_STYLE_SRC = ["'self'"]

# Источники для изображений
CSP_IMG_SRC = ["'self'", 'data:']

# Источники для медиафайлов (аудио, видео)
CSP_MEDIA_SRC = ["'self'"]

# Источники для шрифтов
CSP_FONT_SRC = ["'self'"]

# Источники для объектов (Flash, PDF и т.д.)
CSP_OBJECT_SRC = ["'none'"]

# Источники для фреймов
CSP_FRAME_SRC = ["'self'"]

# Разрешенные домены для отправки XMLHttpRequest, WebSocket или EventSource
CSP_CONNECT_SRC = ["'self'"]

# ------------------ ДОПОЛНИТЕЛЬНЫЕ ДИРЕКТИВЫ CSP -------------------

# Разрешенные источники для worker скриптов
CSP_WORKER_SRC = ["'self'"]

# Разрешенные источники для манифестов веб-приложений
CSP_MANIFEST_SRC = ["'self'"]


# ------------------ ДИРЕКТИВЫ ДЛЯ ЗАГРУЗКИ РЕСУРСОВ -------------------

# Разрешает загрузку ресурсов только по HTTPS
CSP_BLOCK_ALL_MIXED_CONTENT = True

# Запрещает понижение с HTTPS до HTTP
CSP_UPGRADE_INSECURE_REQUESTS = True

# ------------------ ЗАЩИТА ОТ CLICKJACKING -------------------

# Запрет на отображение сайта во фреймах (защита от кликджекинга)
X_FRAME_OPTIONS = 'DENY'

# Управление встраиванием страницы во фреймы через CSP
CSP_FRAME_ANCESTORS = ["'self'"]

# ------------------ ДИРЕКТИВЫ SANDBOX -------------------

# Применяет sandbox-ограничения к странице
CSP_SANDBOX = None

# ------------------ НАСТРОЙКИ ОТЧЕТОВ О НАРУШЕНИЯХ -------------------

# URL для отправки отчетов о нарушениях CSP
CSP_REPORT_URI = None

# Только отправлять отчеты, но не блокировать контент (режим мониторинга)
CSP_REPORT_ONLY = False

# ------------------ НАСТРОЙКИ ДЛЯ НАТИВНЫХ ПРИЛОЖЕНИЙ -------------------

# Разрешенные URI-схемы для нативных приложений
CSP_FORM_ACTION = ["'self'"]


# ------------------ ОТЛАДКА CSP -------------------

# Включить отладочные сообщения CSP в логах Django
CSP_DEBUG = DEBUG
